---
projects:
  - project_name: kubernetes
    tests:
      - metric: events
        # additional_setup_func: SetupEventsMetric
        from: 2017-09-01T00:00:00Z
        to: 2017-10-01T00:00:00Z
        n: 1
        expected:
          - - 3
        data: KubernetesEventsMetric
      - metric: reviewers
        # additional_setup_func: SetupReviewersMetric
        from: 2017-07-09T00:00:00Z
        to: 2017-07-25T00:00:00Z
        n: 1
        expected:
          - - reviewers,All
            - 7
          - - reviewers,Group
            - 5
          - - reviewers,Mono-group
            - 1
        data: KubernetesReviewersMetric
      - metric: hist_reviewers
        #additional_setup_func: SetupReviewersHistMetric
        n: 1
        period: 1 week
        replaces:
          - - ' >= 5'
            - ' >= 0'
          - - ' >= 3'
            - ' >= 0'
        expected:
          - - reviewers_hist,All
            - Actor 1
            - 4
          - - reviewers_hist,All
            - Actor 2
            - 4
          - - reviewers_hist,Group
            - Actor 2
            - 4
          - - reviewers_hist,All
            - Actor 3
            - 2
          - - reviewers_hist,Group
            - Actor 1
            - 2
          - - reviewers_hist,Group
            - Actor 3
            - 1
        data: KubernetesReviewersHistMetric
data:
  KubernetesReviewersHistMetric:
    # id, name, org_id, org_login, repo_group
    repos:
      - - 1
        - Repo 1
        - 1
        - Org
        - Group
      - - 2
        - Repo 2
        - 1
        - Org
        - Group
    # eid, etype, aid, rid, public, created_at, aname, rname, orgid
    events:
      - - 1
        - T
        - 1
        - 1
        - true
        - 2017-11-07T12:27:50.44790244Z
        - Actor 1
        - Repo 1
        - 1
      - - 2
        - T
        - 2
        - 2
        - true
        - 2017-11-07T12:27:50.44790244Z
        - Actor 2
        - Repo 2
        - 1
      - - 3
        - T
        - 3
        - 1
        - true
        - 2017-11-07T12:27:50.44790244Z
        - Actor 3
        - Repo 1
        - 1
      - - 4
        - T
        - 1
        - 3
        - true
        - 2017-11-07T12:27:50.44790244Z
        - Actor 1
        - Repo 3
        - 2
      - - 5
        - T
        - 2
        - 2
        - true
        - 2017-11-07T12:27:50.44790244Z
        - Actor 2
        - Repo 2
        - 1
      - - 6
        - T
        - 2
        - 2
        - true
        - 2017-11-07T12:27:50.44790244Z
        - Actor 2
        - Repo 2
        - 1
      - - 7
        - T
        - 2
        - 2
        - true
        - 2017-11-07T12:27:50.44790244Z
        - Actor 2
        - Repo 2
        - 1
      - - 8
        - T
        - 3
        - 4
        - true
        - 2017-11-07T12:27:50.44790244Z
        - Actor 3
        - Repo 4
        - 2
      - - 9
        - T
        - 1
        - 5
        - true
        - 2017-11-07T12:27:50.44790244Z
        - Actor 1
        - Repo 5
        - null
      - - 10
        - T
        - 2
        - 5
        - true
        - 2017-11-07T12:27:50.44790244Z
        - Actor 2
        - Repo 5
        - null
      - - 11
        - T
        - 3
        - 5
        - true
        - 2017-11-07T12:27:50.44790244Z
        - Actor 3
        - Repo 5
        - null
      - - 12
        - T
        - 1
        - 5
        - true
        - 2017-11-07T12:27:50.44790244Z
        - Actor 1
        - Repo 5
        - null
      - - 13
        - T
        - 1
        - 1
        - true
        - 2017-11-07T12:27:50.44790244Z
        - Actor 1
        - Repo 1
        - 1
    # iid, eid, lid, lname, created_at
    # repo_id, repo_name, actor_id, actor_login, type, issue_number
    issue_event_labels:
      - - 1
        - 1
        - 1
        - lgtm
        - 2017-11-07T12:27:50.44790244Z
        - 1
        - Repo 1
        - 1
        - Actor 1
        - T
        - 1
      - - 2
        - 2
        - 2
        - approved
        - 2017-11-07T12:27:50.44790244Z
        - 2
        - Repo 2
        - 2
        - Actor 2
        - T
        - 2
      - - 5
        - 5
        - 5
        - lgtm
        - 2017-11-07T12:27:50.44790244Z
        - 2
        - Repo 2
        - 2
        - Actor 2
        - T
        - 5
      - - 6
        - 6
        - 6
        - approved
        - 2017-11-07T12:27:50.44790244Z
        - 2
        - Repo 2
        - 2
        - Actor 2
        - T
        - 6
      - - 6
        - 9
        - 1
        - lgtm
        - 2017-11-07T12:27:50.44790244Z
        - 5
        - Repo 5
        - 1
        - Actor 1
        - T
        - 6
      - - 10
        - 10
        - 10
        - other
        - 2017-11-07T12:27:50.44790244Z
        - 5
        - Repo 5
        - 2
        - Actor 2
        - T
        - 10
      - - 12
        - 12
        - 1
        - lgtm
        - 2017-11-07T12:27:50.44790244Z
        - 5
        - Repo 5
        - 3
        - Actor 3
        - T
        - 12
    # append to all rows in "texts"
    texts_append:
      - - 0
        - ""
        - 0
        - ""
        - D
    # eid, body, created_at
    texts:
      - - 3
        - /lgtm
        - 2017-11-07T12:27:50.44790244Z
      - - 4
        - ' /APPROVE '
        - 2017-11-07T12:27:50.44790244Z
      - - 7
        - ' /LGtm '
        - 2017-11-07T12:27:50.44790244Z
      - - 8
        - "\t/AppROve\n"
        - 2017-11-07T12:27:50.44790244Z
      - - 11
        - /lGtM with additional text
        - 2017-11-07T12:27:50.44790244Z
      - - 13
        - |-
          Line 1
          /lGtM
          Line 2
        - 2017-11-07T12:27:50.44790244Z
  KubernetesEventsMetric:
    # eid, etype, aid, rid, public, created_at, aname, rname, orgid
    events:
      - - 1
        - T
        - 1
        - 1
        - true
        - 2017-09-01T00:00:00Z
        - Actor 1
        - Repo 1
        - 1
      - - 2
        - T
        - 2
        - 2
        - true
        - 2017-09-02T00:00:00Z
        - Actor 2
        - Repo 2
        - 1
      - - 3
        - T
        - 3
        - 1
        - true
        - 2017-09-03T00:00:00Z
        - Actor 3
        - Repo 1
        - 1
      - - 4
        - T
        - 1
        - 1
        - true
        - 2017-10-04T00:00:00Z
        - Actor 1
        - Repo 1
        - 1
  KubernetesReviewersMetric:
    # id, name, org_id, org_login, repo_group
    repos:
      - - 1
        - Repo 1
        - 1
        - Org 1
        - Group
      - - 2
        - Repo 2
        - 1
        - Org 1
        - Group
      - - 3
        - Repo 3
        - 2
        - Org 2
        - Mono-group
      - - 4
        - Repo 4
        - 2
        - Org 2
        - null
      - - 5
        - Repo 5
        - null
        - null
        - null
    # eid, etype, aid, rid, public, created_at, aname, rname, orgid
    events:
      - - 1
        - T
        - 1
        - 1
        - true
        - 2017-07-10T00:00:00Z
        - Actor 1
        - Repo 1
        - 1
      - - 2
        - T
        - 2
        - 2
        - true
        - 2017-07-11T00:00:00Z
        - Actor 2
        - Repo 2
        - 1
      - - 3
        - T
        - 3
        - 1
        - true
        - 2017-07-12T00:00:00Z
        - Actor 3
        - Repo 1
        - 1
      - - 4
        - T
        - 4
        - 3
        - true
        - 2017-07-13T00:00:00Z
        - Actor 4
        - Repo 3
        - 2
      - - 5
        - T
        - 5
        - 2
        - true
        - 2017-07-14T00:00:00Z
        - Actor 5
        - Repo 2
        - 1
      - - 6
        - T
        - 5
        - 2
        - true
        - 2017-07-15T00:00:00Z
        - Actor 5
        - Repo 2
        - 1
      - - 7
        - T
        - 3
        - 2
        - true
        - 2017-07-16T00:00:00Z
        - Actor 5
        - Repo 2
        - 1
      - - 8
        - T
        - 6
        - 4
        - true
        - 2017-07-17T00:00:00Z
        - Actor 6
        - Repo 4
        - 2
      - - 9
        - T
        - 7
        - 5
        - true
        - 2017-07-18T00:00:00Z
        - Actor 7
        - Repo 5
        - null
      - - 10
        - T
        - 8
        - 5
        - true
        - 2017-07-19T00:00:00Z
        - Actor 8
        - Repo 5
        - null
      - - 11
        - T
        - 9
        - 5
        - true
        - 2017-07-20T00:00:00Z
        - Actor 9
        - Repo 5
        - null
      - - 12
        - T
        - 9
        - 5
        - true
        - 2017-08-10T00:00:00Z
        - Actor X
        - Repo 5
        - null
      - - 13
        - T
        - 10
        - 1
        - true
        - 2017-07-21T00:00:00Z
        - Actor Y
        - Repo 1
        - 1
    # iid, eid, lid, lname, created_at
    # repo_id, repo_name, actor_id, actor_login, type, issue_number
    issue_event_labels:
      - - 1
        - 1
        - 1
        - lgtm
        - 2017-07-10T00:00:00Z
        - 1
        - Repo 1
        - 1
        - Actor 1
        - T
        - 1
      - - 2
        - 2
        - 2
        - approved
        - 2017-07-11T00:00:00Z
        - 2
        - Repo 2
        - 2
        - Actor 2
        - T
        - 2
      - - 5
        - 5
        - 5
        - lgtm
        - 2017-07-14T00:00:00Z
        - 2
        - Repo 2
        - 5
        - Actor 5
        - T
        - 5
      - - 6
        - 6
        - 6
        - approved
        - 2017-07-15T00:00:00Z
        - 2
        - Repo 2
        - 5
        - Actor 5
        - T
        - 6
      - - 6
        - 9
        - 1
        - lgtm
        - 2017-07-18T00:00:00Z
        - 5
        - Repo 5
        - 7
        - Actor 7
        - T
        - 6
      - - 10
        - 10
        - 10
        - other
        - 2017-07-19T00:00:00Z
        - 5
        - Repo 5
        - 8
        - Actor 8
        - T
        - 10
      - - 12
        - 12
        - 1
        - lgtm
        - 2017-08-10T00:00:00Z
        - 5
        - Repo 5
        - 9
        - Actor 9
        - T
        - 12
    # append to all rows in "texts"
    texts_append:
      - - 0
        - ""
        - 0
        - ""
        - D
    # eid, body, created_at
    texts:
      - - 3
        - /lgtm
        - 2017-07-12T00:00:00Z
      - - 4
        - ' /LGTM '
        - 2017-07-13T00:00:00Z
      - - 7
        - ' /Approve '
        - 2017-07-16T00:00:00Z
      - - 8
        - "\t/lgTM\n"
        - 2017-07-17T00:00:00Z
      - - 11
        - /APPROVE with additional text
        - 2017-07-20T00:00:00Z
      - - 13
        - |-
          Line 1
          /lGtM
          Line 2
        - 2017-07-21T00:00:00Z
