	var testCases = []MetricTestCase{
		{
			setup:  setupPRsStateMetric,
			metric: "prs_state",
			from:   ft(2017, 10),
			to:     ft(2017, 11),
			n:      1,
			expected: [][]interface{}{
				{"prs_approve_state;All;approved,awaiting", "3.00", "1.00"},
				{"prs_approve_state;G1;approved,awaiting", "2.00", "1.00"},
				{"prs_approve_state;G2;approved,awaiting", "1.00", "0.00"},
			},
		},
		{
			setup:  setupBlockedPRsMetric,
			metric: "prs_blocked",
			from:   ft(2017, 10),
			to:     ft(2017, 11),
			n:      1,
			expected: [][]interface{}{
				{"prs_blocked;All;all_prs,needs_ok_to_test,release_note_label_needed,no_lgtm,no_approve,do_not_merge", "4.00", "1.00", "1.00", "4.00", "3.00", "1.00"},
				{"prs_blocked;G1;all_prs,needs_ok_to_test,release_note_label_needed,no_lgtm,no_approve,do_not_merge", "2.00", "1.00", "0.00", "2.00", "1.00", "0.00"},
				{"prs_blocked;G2;all_prs,needs_ok_to_test,release_note_label_needed,no_lgtm,no_approve,do_not_merge", "2.00", "0.00", "1.00", "2.00", "2.00", "1.00"},
			},
		},
		{
			setup:  setupTimeMetrics,
			metric: "opened_to_merged",
			from:   ft(2017, 7),
			to:     ft(2017, 8),
			n:      1,
			expected: [][]interface{}{
				{"opened_to_merged;All;percentile_15,median,percentile_85", 480, 504, 624},
				{"opened_to_merged;Group2;percentile_15,median,percentile_85", 504, 504, 504},
				{"opened_to_merged;Group1;percentile_15,median,percentile_85", 480, 480, 552},
			},
		},
		{
			setup:  setupTimeMetrics,
			metric: "time_metrics",
			from:   ft(2017, 7),
			to:     ft(2017, 8),
			n:      1,
			expected: [][]interface{}{
				{"time_metrics;All_All;all_median_open_to_lgtm,all_median_lgtm_to_approve,all_median_approve_to_merge,all_percentile_85_open_to_lgtm,all_percentile_85_lgtm_to_approve,all_percentile_85_approve_to_merge,yes_median_open_to_lgtm,yes_median_lgtm_to_approve,yes_median_approve_to_merge,yes_percentile_85_open_to_lgtm,yes_percentile_85_lgtm_to_approve,yes_percentile_85_approve_to_merge,no_median_open_to_lgtm,no_median_lgtm_to_approve,no_median_approve_to_merge,no_percentile_85_open_to_lgtm,no_percentile_85_lgtm_to_approve,no_percentile_85_approve_to_merge", 144, 120, 216, 264, 168, 288, 120, 120, 216, 144, 144, 240, 192, 72, 192, 264, 168, 288},
				{"time_metrics;All_XL;all_median_open_to_lgtm,all_median_lgtm_to_approve,all_median_approve_to_merge,all_percentile_85_open_to_lgtm,all_percentile_85_lgtm_to_approve,all_percentile_85_approve_to_merge,yes_median_open_to_lgtm,yes_median_lgtm_to_approve,yes_median_approve_to_merge,yes_percentile_85_open_to_lgtm,yes_percentile_85_lgtm_to_approve,yes_percentile_85_approve_to_merge,no_median_open_to_lgtm,no_median_lgtm_to_approve,no_median_approve_to_merge,no_percentile_85_open_to_lgtm,no_percentile_85_lgtm_to_approve,no_percentile_85_approve_to_merge", 264, 72, 288, 264, 72, 288, 0, 0, 0, 0, 0, 0, 264, 72, 288, 264, 72, 288},
				{"time_metrics;All_XS;all_median_open_to_lgtm,all_median_lgtm_to_approve,all_median_approve_to_merge,all_percentile_85_open_to_lgtm,all_percentile_85_lgtm_to_approve,all_percentile_85_approve_to_merge,yes_median_open_to_lgtm,yes_median_lgtm_to_approve,yes_median_approve_to_merge,yes_percentile_85_open_to_lgtm,yes_percentile_85_lgtm_to_approve,yes_percentile_85_approve_to_merge,no_median_open_to_lgtm,no_median_lgtm_to_approve,no_median_approve_to_merge,no_percentile_85_open_to_lgtm,no_percentile_85_lgtm_to_approve,no_percentile_85_approve_to_merge", 120, 120, 192, 192, 168, 240, 120, 120, 240, 120, 120, 240, 192, 168, 192, 192, 168, 192},
				{"time_metrics;Group1_All;all_median_open_to_lgtm,all_median_lgtm_to_approve,all_median_approve_to_merge,all_percentile_85_open_to_lgtm,all_percentile_85_lgtm_to_approve,all_percentile_85_approve_to_merge,yes_median_open_to_lgtm,yes_median_lgtm_to_approve,yes_median_approve_to_merge,yes_percentile_85_open_to_lgtm,yes_percentile_85_lgtm_to_approve,yes_percentile_85_approve_to_merge,no_median_open_to_lgtm,no_median_lgtm_to_approve,no_median_approve_to_merge,no_percentile_85_open_to_lgtm,no_percentile_85_lgtm_to_approve,no_percentile_85_approve_to_merge", 120, 120, 192, 192, 168, 240, 120, 120, 240, 120, 120, 240, 192, 168, 192, 192, 168, 192},
				{"time_metrics;Group1_XS;all_median_open_to_lgtm,all_median_lgtm_to_approve,all_median_approve_to_merge,all_percentile_85_open_to_lgtm,all_percentile_85_lgtm_to_approve,all_percentile_85_approve_to_merge,yes_median_open_to_lgtm,yes_median_lgtm_to_approve,yes_median_approve_to_merge,yes_percentile_85_open_to_lgtm,yes_percentile_85_lgtm_to_approve,yes_percentile_85_approve_to_merge,no_median_open_to_lgtm,no_median_lgtm_to_approve,no_median_approve_to_merge,no_percentile_85_open_to_lgtm,no_percentile_85_lgtm_to_approve,no_percentile_85_approve_to_merge", 120, 120, 192, 192, 168, 240, 120, 120, 240, 120, 120, 240, 192, 168, 192, 192, 168, 192},
				{"time_metrics;Group2_All;all_median_open_to_lgtm,all_median_lgtm_to_approve,all_median_approve_to_merge,all_percentile_85_open_to_lgtm,all_percentile_85_lgtm_to_approve,all_percentile_85_approve_to_merge,yes_median_open_to_lgtm,yes_median_lgtm_to_approve,yes_median_approve_to_merge,yes_percentile_85_open_to_lgtm,yes_percentile_85_lgtm_to_approve,yes_percentile_85_approve_to_merge,no_median_open_to_lgtm,no_median_lgtm_to_approve,no_median_approve_to_merge,no_percentile_85_open_to_lgtm,no_percentile_85_lgtm_to_approve,no_percentile_85_approve_to_merge", 144, 144, 216, 144, 144, 216, 144, 144, 216, 144, 144, 216, 0, 0, 0, 0, 0, 0},
			},
		},
		{
			setup:  setupPRCommentsMetric,
			metric: "pr_comments",
			from:   ft(2017, 8),
			to:     ft(2017, 9),
			n:      1,
			expected: [][]interface{}{
				{"pr_comments_median,pr_comments_percentile_85,pr_comments_percentile_95", 2, 5, 5},
			},
		},
		{
			setup:  setupTopCommentersMetric,
			metric: "hist_commenters",
			period: "1 week",
			n:      1,
			replaces: [][2]string{
				{" >= 30", " >= 2"},
				{" >= 20", " >= 2"},
			},
			expected: [][]interface{}{
				{"top_commenters,All", "A1", 3},
				{"top_commenters,All", "A2", 3},
				{"top_commenters,All", "A3", 2},
				{"top_commenters,Group 1", "A2", 2},
			},
		},
		{
			setup:  setupCommunityStatsMetric,
			metric: "watchers",
			from:   ft(2017, 8, 1),
			to:     ft(2017, 9, 15),
			n:      1,
			expected: [][]interface{}{
				{"contrib;All;watchers,forks,open_issues", 158, 158, 158},
				{"contrib;Org2/Repo4;watchers,forks,open_issues", 111, 112, 113},
				{"contrib;Repo3;watchers,forks,open_issues", 23, 22, 21},
				{"contrib;Org1/Repo2;watchers,forks,open_issues", 13, 12, 11},
				{"contrib;Org1/Repo1;watchers,forks,open_issues", 11, 12, 13},
			},
		},
		{
			setup:  setupFirstNonAuthorActivityMetric,
			metric: "first_non_author_activity",
			from:   ft(2017, 9),
			to:     ft(2017, 10),
			n:      1,
			expected: [][]interface{}{
				{"non_author;Group2;percentile_15,median,percentile_85", 72, 72, 72},
				{"non_author;All;percentile_15,median,percentile_85", 24, 48, 96},
				{"non_author;Group1;percentile_15,median,percentile_85", 24, 24, 48},
			},
		},
		{
			setup:  setupApproversMetric,
			metric: "approvers",
			from:   ft(2017, 7),
			to:     ft(2017, 8),
			n:      1,
			expected: [][]interface{}{
				{"approvers,Group", 3},
				{"approvers,Mono-group", 1},
			},
		},
		{
			setup:  setupPRApproversMetric,
			metric: "other_approver",
			from:   ft(2017, 10),
			to:     ft(2017, 11),
			n:      1,
			expected: [][]interface{}{
				{"other_approvers;All;all_suggested_approvers,no_approver,other_approver,suggested_approver", "4.00", "1.00", "2.00", "1.00"},
				{"other_approvers;G1;all_suggested_approvers,no_approver,other_approver,suggested_approver", "2.00", "1.00", "0.00", "1.00"},
				{"other_approvers;G2;all_suggested_approvers,no_approver,other_approver,suggested_approver", "1.00", "0.00", "1.00", "0.00"},
			},
		},
		{
			setup:  setupPRAuthorsMetric,
			metric: "hist_pr_authors",
			period: "1 week",
			n:      1,
			replaces: [][2]string{
				{" >= 5", " >= 1"},
				{" >= 3", " >= 1"},
			},
			expected: [][]interface{}{
				{"hist_pr_authors,All", "Actor 1", 3},
				{"hist_pr_authors,All", "Actor 2", 3},
				{"hist_pr_authors,All", "Actor 3", 3},
				{"hist_pr_authors,Group 1", "Actor 2", 2},
				{"hist_pr_authors,Group 1", "Actor 3", 2},
				{"hist_pr_authors,Group 1", "Actor 1", 1},
				{"hist_pr_authors,Group 2", "Actor 1", 1},
				{"hist_pr_authors,Group 2", "Actor 3", 1},
			},
		},
		{
			setup:  setupPRAuthorsMetric,
			metric: "hist_pr_companies",
			period: "1 week",
			n:      1,
			replaces: [][2]string{
				{" >= 5", " >= 1"},
				{" >= 3", " >= 1"},
			},
			expected: [][]interface{}{
				{"hist_pr_companies,All", "company1", 6},
				{"hist_pr_companies,All", "company2", 3},
				{"hist_pr_companies,Group 1", "company1", 3},
				{"hist_pr_companies,Group 1", "company2", 2},
				{"hist_pr_companies,Group 2", "company1", 1},
				{"hist_pr_companies,Group 2", "company2", 1},
			},
		},
		{
			setup:  setupIssuesAgeMetric,
			metric: "issues_age",
			from:   ft(2017, 10),
			to:     ft(2017, 11),
			n:      1,
			expected: [][]interface{}{
				{"issues_age;All_All_kind1_All;number,median", "1.00", 240},
				{"issues_age;All_sig1_All_All;number,median", "1.00", 240},
				{"issues_age;All_sig1_kind1_All;number,median", "1.00", 240},
				{"issues_age;All_sigX_All_All;number,median", "1.00", 240},
				{"issues_age;All_sigX_kind1_All;number,median", "1.00", 240},
				{"issues_age;G1_All_All_All;number,median", "2.00", 240},
				{"issues_age;G1_All_kind1_All;number,median", "1.00", 240},
				{"issues_age;G1_sig1_All_All;number,median", "1.00", 240},
				{"issues_age;G1_sig1_kind1_All;number,median", "1.00", 240},
				{"issues_age;G1_sigX_All_All;number,median", "1.00", 240},
				{"issues_age;G1_sigX_kind1_All;number,median", "1.00", 240},
				{"issues_age;All_All_All_All;number,median", "4.00", 480},
				{"issues_age;All_All_kind2_All;number,median", "1.00", 480},
				{"issues_age;All_All_kindX_All;number,median", "1.00", 480},
				{"issues_age;All_sig2_All_All;number,median", "1.00", 480},
				{"issues_age;All_sig2_kind2_All;number,median", "1.00", 480},
				{"issues_age;All_sig2_kindX_All;number,median", "1.00", 480},
				{"issues_age;G2_All_All_All;number,median", "1.00", 480},
				{"issues_age;G2_All_kind2_All;number,median", "1.00", 480},
				{"issues_age;G2_All_kindX_All;number,median", "1.00", 480},
				{"issues_age;G2_sig2_All_All;number,median", "1.00", 480},
				{"issues_age;G2_sig2_kind2_All;number,median", "1.00", 480},
				{"issues_age;G2_sig2_kindX_All;number,median", "1.00", 480},
				{"issues_age;All_All_kind3_All;number,median", "1.00", 744},
				{"issues_age;G1_All_kind3_All;number,median", "1.00", 744},
				{"issues_age;All_sig4_All_All;number,median", "1.00", 984},
			},
		},
	}
